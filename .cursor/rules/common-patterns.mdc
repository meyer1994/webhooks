---
description: Applies common coding patterns and conventions for the Flower project
alwaysApply: true
---

# Flower Project Common Patterns & Conventions

This rule captures the most frequent coding patterns and conventions used across the codebase. For more detailed guides, refer to the specific rules linked below.

## üõ† Tech Stack

- **Frontend**: Nuxt 4, Vue 3 (Composition API), Nuxt UI 4, Tailwind v4
- **Backend**: tRPC, Drizzle ORM (SQLite/D1), Cloudflare R2 & Vectorize
- **Language**: TypeScript (Strict mode)
- See [Project Structure](mdc:.cursor/rules/structure.mdc) for directory layout.

## üß† General Principles

- **Assume Happy Path**: Always assume the happy path unless explicitly told otherwise. Avoid defensive programming or complex error handling if not requested, to keep the code simple and readable.

## üé® Formatting & Style (ESLint Stylistic)

- **No semicolons**, **Trailing commas**, **Line length**: 100 chars, **Single quotes**.

## üèó Frontend Patterns

### 1. Component Structure

- Always use `<script setup lang="ts">`
- Prefix components by type: `TableUsers.vue`, `FormUser.vue`, `AppShell.vue`
- Use `useTemplateRef` for accessing DOM or child components.

### 2. Data Fetching & State

- **Fetch at Page Level**: Use `useAsyncData` or `$trpc.*.useQuery()`.
- **Child Components**: Should be "dumb" (presentational).
- See [Data Fetching Patterns](mdc:.cursor/rules/ui-pages.mdc) for detailed examples.

### 3. UI Components

- **Forms**: Use Nuxt UI 4 + Zod. See [Form Rules](mdc:.cursor/rules/ui-form.mdc).
- **Tables**: Use Nuxt UI 4 `UTable`. See [Table Rules](mdc:.cursor/rules/ui-table.mdc).
- **Colors & Icons**: Use semantic colors and Lucide icons. See [UI Colors](mdc:.cursor/rules/ui-colors.mdc).

### 4. Common Nuxt UI Components

- `<UButton>`: Versatile button for links or actions.
- `<UInput>`: Text input field for user data entry.
- `<USelect>`: Dropdown select for choosing from options.
- `<UCheckbox>`: Toggle between checked and unchecked states.
- `<UAlert>`: Callout to draw attention to important information.
- `<UModal>`: Dialog window for focused interaction.
- `<UCard>`: Container with header, body, and footer sections.
- `<UTabs>`: Tab panels for organizing content.
- `<UTooltip>`: Informative popup on element hover.
- `<UBadge>`: Status or category indicator with short text.

### 5. Common VueUse Functions

- `useMouse()`: Tracks mouse position reactively.
- `useLocalStorage()`: Synchronizes state with localStorage.
- `useClipboard()`: Reactive clipboard access (copy/paste).
- `useDark()`: Reactive dark mode detection and toggle.
- `useFetch()`: Reactive HTTP requests with state management.
- `useWindowSize()`: Tracks window dimensions reactively.
- `useBreakpoints()`: Reactive breakpoints for responsive design.
- `useEventListener()`: Reactive event listener management.
- `useIntervalFn()`: Controlled interval execution.
- `useTimeoutFn()`: Controlled timeout execution.

## üîó tRPC Patterns

- **Client Usage**: Use reactive queries and mutations. See [tRPC Client Guide](mdc:.cursor/rules/trpc-client.mdc).
- **Server Implementation**: Keep procedures thin; move logic to `server/utils/`. See [tRPC Route Patterns](mdc:.cursor/rules/trpc-routes.mdc).

## üóÑ Backend Patterns

- **Drizzle ORM**: Use `T` prefix for tables and `R` for relations. See [Database Patterns](mdc:.cursor/rules/database.mdc).
- **Storage & Vector**:
  - `ctx.storage`: Standardized interface for S3/R2 (`get`, `put`, `del`, `list`).
  - `ctx.vector`: Interface for semantic search (`set`, `get`, `search`).

## üí° Pro Tips

- Use `@/` or `~/` for `app/` and `@@/` or `~~/` for root.
- Use `useToast()` for user notifications.
